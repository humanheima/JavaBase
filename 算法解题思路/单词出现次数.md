给定一段字符串（英文），统计其中每个“单词”出现的次数（大小写不敏感）。返回一个 Map<String, Integer> 表示每个单词的出现频次。
你可以假设：
输入可能包含标点符号；
单词之间由空格分隔；
单词大小写应统一处理为小写。
示例输入：String input = "Hello world!Hello, Android. Hello MiChat.";
示例输出：{hello=3, world=1, android=1, michat=1}



感谢您的提醒！题目要求统计单词出现频次并返回 `Map<String, Integer>`，而输入 `"world!Hello"` 应正确分割为单词并计数。以下是修正后的 Java 实现，专注于将输入字符串分割并统计单词频次，不使用正则表达式或 `String.split()`，并确保返回 `Map<String, Integer>`：

```java
import java.util.HashMap;
import java.util.Map;

public class WordFrequencyCounter {
    public Map<String, Integer> countWords(String input) {
        // 处理空输入或 null
        if (input == null || input.trim().isEmpty()) {
            return new HashMap<>();
        }

        // 初始化结果映射
        Map<String, Integer> wordFreq = new HashMap<>();
        
        // 转换为小写并清理标点符号
        StringBuilder cleaned = new StringBuilder();
        for (char c : input.toLowerCase().toCharArray()) {
            if (c >= 'a' && c <= 'z') { // 仅保留小写字母
                cleaned.append(c);
            } else {
                cleaned.append(' '); // 将标点替换为空格
            }
        }

        // 手动按空格分隔单词并计数
        StringBuilder currentWord = new StringBuilder();
        for (char c : cleaned.toString().toCharArray()) {
            if (c == ' ') {
                // 单词结束.
                // 单词结束，注意有可能多个空格连着，比如原始字符串是 "Hello! World" 是这种。
                if (currentWord.length() > 0) {
                    String word = currentWord.toString();
                    wordFreq.put(word, wordFreq.getOrDefault(word, 0) + 1);
                    currentWord.setLength(0); // 重置当前单词
                }
            } else {
                currentWord.append(c); // 构建当前单词
            }
        }

        // 处理最后一个单词
        if (currentWord.length() > 0) {
            String word = currentWord.toString();
            wordFreq.put(word, wordFreq.getOrDefault(word, 0) + 1);
        }

        return wordFreq;
    }

    // 测试代码
    public static void main(String[] args) {
        WordFrequencyCounter counter = new WordFrequencyCounter();
        String input = "world!Hello";
        Map<String, Integer> result = counter.countWords(input);
        System.out.println(result); // 输出: {world=1, hello=1}
    }
}
```

### 代码说明：
1. **输入验证**：检查输入是否为 `null` 或空字符串，若是则返回空 `HashMap`。
2. **清理标点**：
    - 将输入字符串转换为小写。
    - 逐字符检查，仅保留小写字母（`a-z`），将标点符号（如 `!`）替换为空格，存入 `StringBuilder`。
3. **手动分词并计数**：
    - 遍历清理后的字符串，逐字符构建单词。
    - 遇到空格时，将当前单词（若非空）加入 `HashMap`，更新其频次。
    - 清空当前单词，继续处理下一个。
    - 循环结束后，处理可能存在的最后一个单词。
4. **输出**：返回 `Map<String, Integer>`，其中键为单词（小写），值为出现次数。

### 运行结果：
对于输入 `"world!Hello"`：
- 清理后字符串为 `"world hello"`。
- 分割并计数后得到 `{world=1, hello=1}`。
- 输出：`{world=1, hello=1}`。

### 特点：
- **不使用正则表达式**：通过字符范围检查（`a-z`）清理标点。
- **不使用 `String.split()`**：手动检测空格分隔单词。
- **时间复杂度**：O(n)，其中 n 为输入字符串长度。
- **符合要求**：正确处理 `"world!Hello"`，返回 `{world=1, hello=1}`，并满足题目要求的返回类型 `Map<String, Integer>`。

这个实现修正了之前的错误（返回列表而非映射），确保满足所有要求，代码清晰且高效。